<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mi Jueguito de H√°bitos</title>

<style>
:root{
  --rosa:#f9c5d1;
  --rosa2:#fde7ee;
  --card:#fff5f8;
  --texto:#6a4a57;
}

body{
  margin:0;
  font-family:'Quicksand', system-ui, sans-serif;
  background:var(--rosa);
  color:var(--texto);
}

.app{
  max-width:430px;
  margin:auto;
  padding:16px;
}

header{
  text-align:center;
  font-size:1.6em;
  font-weight:700;
  margin-bottom:10px;
}

.card{
  background:var(--card);
  border-radius:20px;
  padding:16px;
  margin-bottom:14px;
  box-shadow:0 6px 14px rgba(0,0,0,.06);
}

h2{
  margin:0 0 10px;
  font-size:1.1em;
}

.task{
  display:flex;
  align-items:flex-start;
  gap:10px;
  margin-bottom:8px;
}

.task input{
  transform:scale(1.2);
}

.task span{
  font-size:.9em;
}

.task small{
  display:block;
  font-size:.75em;
  opacity:.8;
}

.progress{
  margin-top:10px;
  height:14px;
  background:#f3a6bb;
  border-radius:20px;
  overflow:hidden;
}

.fill{
  height:100%;
  width:0%;
  background:#fff;
  transition:.4s;
}

.reward{
  text-align:center;
  padding:14px;
  border-radius:18px;
  border:2px dashed #f3a6bb;
  opacity:.3;
}

.reward.unlocked{
  opacity:1;
}

.bunny{
  position:fixed;
  bottom:18px;
  right:18px;
  font-size:64px;
  transition:.3s;
}

.bunny.happy{
  transform:scale(1.15) rotate(-3deg);
}

button{
  border:none;
  background:none;
  font-size:1.1em;
  cursor:pointer;
}

.history li{
  font-size:.85em;
}
</style>
</head>

<body>
<div class="app">

<header>üå∏ Mi Jueguito de H√°bitos üê∞</header>

<div class="card" id="habitList"></div>

<div class="card">
<div class="progress"><div class="fill"></div></div>
</div>

<div class="card reward" id="reward">
üéÄ Recompensa Doramas<br>
<small>Se desbloquea con 80%</small>
</div>

<div class="card history">
<h2>üìÖ Historial</h2>
<ul id="history"></ul>
</div>

<button id="reset">üíî Reiniciar d√≠a</button>

</div>

<div class="bunny" id="bunny">üê∞</div>

<script>
// ====== DATOS ======
const HABITOS = [
  {
    id:"agua1",
    nombre:"Tomar agua (1/4)",
    desc:"Un vaso grande apenas empezar la ma√±ana.",
    diario:true
  },
  {
    id:"agua2",
    nombre:"Tomar agua (2/4)",
    desc:"Segundo vaso grande antes de almorzar.",
    diario:true
  },
  {
    id:"agua3",
    nombre:"Tomar agua (3/4)",
    desc:"Otro vaso por la tarde.",
    diario:true
  },
  {
    id:"agua4",
    nombre:"Tomar agua (4/4)",
    desc:"√öltimo vaso para completar 2L.",
    diario:true
  },
  {
    id:"rutina_manana",
    nombre:"Rutina matutina y orden",
    desc:"Levantarte, hacer la cama, ordenar, asearte, vestirte y peinarte.",
    diario:true
  },
  {
    id:"dientes_manana",
    nombre:"Cepillado + lengua (ma√±ana)",
    desc:"Cepillar dientes y lengua al despertar.",
    diario:true
  }
];

// ====== ESTADO ======
const today = new Date().toLocaleDateString();
const list = document.getElementById("habitList");
const fill = document.querySelector(".fill");
const bunny = document.getElementById("bunny");
const reward = document.getElementById("reward");

function loadState(){
  if(localStorage.getItem("date") !== today){
    saveHistory();
    localStorage.removeItem("state");
  }
  const state = JSON.parse(localStorage.getItem("state")||"{}");
  return state;
}

function saveState(state){
  localStorage.setItem("state", JSON.stringify(state));
  localStorage.setItem("date", today);
}

// ====== RENDER ======
function render(){
  const state = loadState();
  list.innerHTML = "<h2>‚òÄÔ∏è H√°bitos diarios</h2>";

  HABITOS.forEach(h=>{
    const checked = state[h.id] || false;
    list.innerHTML += `
      <label class="task">
        <input type="checkbox" ${checked?"checked":""} data-id="${h.id}">
        <span>${h.nombre}<small>${h.desc}</small></span>
      </label>
    `;
  });

  update();
}

// ====== PROGRESO ======
function update(){
  const checks = document.querySelectorAll("input[type=checkbox]");
  const done = [...checks].filter(c=>c.checked).length;
  const percent = Math.round(done/checks.length*100);
  fill.style.width = percent+"%";

  if(percent>=80) reward.classList.add("unlocked");
  else reward.classList.remove("unlocked");
}

// ====== HISTORIAL ======
function saveHistory(){
  const prev = JSON.parse(localStorage.getItem("history")||"[]");
  const state = JSON.parse(localStorage.getItem("state")||"{}");
  const total = HABITOS.length;
  const done = Object.values(state).filter(v=>v).length;
  if(done>0){
    prev.push({date:localStorage.getItem("date"),percent:Math.round(done/total*100)});
    localStorage.setItem("history",JSON.stringify(prev));
  }
}

function loadHistory(){
  const h = JSON.parse(localStorage.getItem("history")||"[]");
  document.getElementById("history").innerHTML =
    h.map(d=>`<li>${d.date} ‚Äî ${d.percent}%</li>`).join("");
}

// ====== EVENTOS ======
document.addEventListener("change",e=>{
  if(e.target.matches("input[type=checkbox]")){
    const state = loadState();
    state[e.target.dataset.id] = e.target.checked;
    saveState(state);
    bunny.classList.add("happy");
    setTimeout(()=>bunny.classList.remove("happy"),300);
    update();
  }
});

document.getElementById("reset").onclick=()=>{
  if(confirm("¬øReiniciar solo el d√≠a de hoy?")){
    saveHistory();
    localStorage.removeItem("state");
    render();
  }
};

// ====== INIT ======
render();
loadHistory();
</script>
</body>
</html>
